<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Compilation Methods • acresFSA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compilation Methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">acresFSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/acresfsa.html">Getting Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/1_compile.html">Compilation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/2_clean.html">Data Cleaning Methods</a></li>
    <li><a class="dropdown-item" href="../articles/acresfsa.html">acresFSA</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/capellett/acresFSA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compilation Methods</h1>
                        <h4 data-toc-skip class="author">C A
Pellett</h4>
            
            <h4 data-toc-skip class="date">2024-12-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/capellett/acresFSA/blob/master/vignettes/1_compile.rmd" class="external-link"><code>vignettes/1_compile.rmd</code></a></small>
      <div class="d-none name"><code>1_compile.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="compilation-of-acreage-data-from-the-us-farm-service-agency">Compilation of Acreage Data from the US Farm Service Agency<a class="anchor" aria-label="anchor" href="#compilation-of-acreage-data-from-the-us-farm-service-agency"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette documents the compilation of the Farm Service Agency
data in to an R package. The goal is to maintain the data integrity,
enhance comparability of the data over time, and reduce file size and
read speed. Additional data validation and cleaning documented in the
next vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"../R/track_dataset.R"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="the-early-years-2009-and-2010">The early years, 2009 and 2010<a class="anchor" aria-label="anchor" href="#the-early-years-2009-and-2010"></a>
</h3>
<p>Irrigation practice information is not included in the FSA data for
these years. Also, some fields were labelled inconsistently. Columns
“Irrigation Practice” and “State County Code” are created here for
forward compatibility. In these tables, it appears that there is a row
for each intended use of each crop on each farm. There are then columns
for the planted acres, prevented acres, and failed acres. The tables are
pivoted so that there is a row for each <em>type</em> (planted,
prevented, and failed) of acreage for each intended use of each crop on
each farm. Then, rows with acreage values of 0 are removed.</p>
</div>
<div class="section level3">
<h3 id="a-transition-year-2011">A Transition Year, 2011<a class="anchor" aria-label="anchor" href="#a-transition-year-2011"></a>
</h3>
<p>The FSA acreage data for 2011 includes irrigation practice, but is
formatted differently from the subsequent years. Now, in addition to
acreage types of Planted, Prevented, and Failed, there are additional
types of Volunteer, Plant and Fail, and Not Planted. Further, each of
these types is either irrigated or not, so there are many types of
acreage. Also, there are columns for total acreage values: Planted
Total, Prevented Total, Failed Total, Volunteer Total, Not Planted
Total, and Plant and Fail Total. The values in the total columns are
equal to the sum of the irrigated and nonirrigated acreage for each
type.</p>
<p>The <em>type</em> columns are pivoted to rows, and the zero values
are removed. The nonirrigated acreage values are unnecessary (because
the irrigated acreage and the total acreage provide that
information).</p>
</div>
<div class="section level3">
<h3 id="state-names-and-abbreviations">State Names and Abbreviations<a class="anchor" aria-label="anchor" href="#state-names-and-abbreviations"></a>
</h3>
<p>There is some variation in the spelling or capitalization of the
State names and abbreviations between the 2009-2010 data and the 2011
data. Fortunately, there are numeric codes for the states, and so the
codes are used to standardize the State names and abbreviations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Create State_table to help clean-up</span></span>
<span><span class="co">## variable spellings of states or abbreviations</span></span>
<span><span class="va">State_table</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">fsa11b</span>, <span class="va">`State Code`</span>, <span class="va">`State Name`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">fsa0</span>, <span class="va">`State Code`</span>, <span class="va">`State Abbrev`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>`State Name`<span class="op">=</span><span class="fu">if_else</span><span class="op">(</span><span class="va">`State Abbrev`</span><span class="op">==</span><span class="st">'MP'</span>, <span class="st">'MARIANA ISLANDS'</span>, <span class="va">`State Name`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fsa1</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">fsa0</span>, <span class="va">fsa11b</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">`State Name`</span>, <span class="op">-</span><span class="va">`State Abbrev`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">State_table</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa1'</span><span class="op">)</span></span>
<span><span class="co">## 542,694 obs. of 15 variables. 65,605,208 bytes</span></span>
<span></span>
<span><span class="co"># all.equal(fsa1[,c('State Code', 'State Name', 'State Abbrev')] |&gt; unique(),</span></span>
<span><span class="co">#           State_table) ## TRUE</span></span>
<span><span class="co">## This checks out...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">fsa0</span>, <span class="va">fsa11</span>, <span class="va">fsa11b</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="present-consistent-files">2012-present: consistent files<a class="anchor" aria-label="anchor" href="#present-consistent-files"></a>
</h3>
<p>The remaining files are more uniform.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">read_fsa</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'../data-raw/downloaded excel files/'</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">read_xlsx</span><span class="op">(</span><span class="va">x</span>, sheet<span class="op">=</span><span class="st">'county_data'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">`Planted and Failed Acres`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">County</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">fsa2</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  `2012`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2012_fsa_acres_jan_2013.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rename</span><span class="op">(</span>`Failed Acres`<span class="op">=</span><span class="st">'Failded Acres'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2012'</span><span class="op">)</span>,</span>
<span>  `2013`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2013_fsa_acres_jan_2014.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2013'</span><span class="op">)</span>,</span>
<span>  `2014`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2014_fsa_acres_jan2014.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2014'</span><span class="op">)</span>,</span>
<span>  `2015`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2015_fsa_acres_01052016.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2015'</span><span class="op">)</span>,</span>
<span>  `2016`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2016_fsa_acres_010417.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2016'</span><span class="op">)</span>,</span>
<span>  `2017`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2017_fsa_acres_010418.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2017'</span><span class="op">)</span>,</span>
<span>  `2018`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2018_fsa_acres_012819.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2018'</span><span class="op">)</span>,</span>
<span>  `2019`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2019_fsa_acres_web_010220.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2019'</span><span class="op">)</span>,</span>
<span>  `2020`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2020_fsa_acres_web_010521.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2020'</span><span class="op">)</span>,</span>
<span>  `2021`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2021_fsa_acres_web_010322.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2021'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">slice</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>`Planted Acres` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`Planted Acres`</span><span class="op">)</span>,</span>
<span>           `Volunteer Acres` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`Volunteer Acres`</span><span class="op">)</span>,</span>
<span>           `Failed Acres` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`Failed Acres`</span><span class="op">)</span>,</span>
<span>           `Prevented Acres` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`Prevented Acres`</span><span class="op">)</span>,</span>
<span>           `Not Planted Acres` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`Not Planted Acres`</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `2022`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2022_fsa_acres_web_010323.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2022'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>`State County Code` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">`State County Code`</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `2023`<span class="op">=</span><span class="fu">read_fsa</span><span class="op">(</span><span class="st">'2023_fsa_acres_web_010224.xlsx'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'2023'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>`State County Code` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">`State County Code`</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  .id<span class="op">=</span><span class="st">'Year'</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2012-2023'</span><span class="op">)</span> </span>
<span><span class="co">## 1,790,332 obs of 16 variables. 158,999,384 bytes</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## calculate Total acres, make tidy</span></span>
<span><span class="va">fsa2b</span> <span class="op">&lt;-</span> <span class="va">fsa2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="st">'Type'</span>, <span class="st">'Acres'</span>, <span class="va">`Planted Acres`</span><span class="op">:</span><span class="va">`Not Planted Acres`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co">## 6,189,540 obs. of 13 variables. 644,259,288 bytes</span></span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2 gather acreage types'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">`State Code`</span>, <span class="va">County</span>, <span class="va">`County Code`</span>, <span class="va">`State County Code`</span>, <span class="va">Year</span>,</span>
<span>                  <span class="va">`Crop`</span>, <span class="va">`Crop Type`</span>, <span class="va">`Crop Code`</span>, <span class="va">`Intended Use`</span>, <span class="va">`Irrigation Practice`</span>, <span class="va">`Type`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>Acres<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Acres</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2 sum acres by county, crop, use, irrigation, and type'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">spread</span><span class="op">(</span><span class="va">`Irrigation Practice`</span>, <span class="va">Acres</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\s*\\w*$"</span>, <span class="st">""</span>, <span class="va">Type</span><span class="op">)</span>,</span>
<span>         I<span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">I</span><span class="op">)</span>,</span>
<span>         N<span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">N</span><span class="op">)</span>,</span>
<span>         O<span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">O</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">O</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>`T`<span class="op">=</span><span class="va">I</span><span class="op">+</span><span class="va">N</span><span class="op">+</span><span class="va">O</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">N</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2 spread irrigation practice, calculate total, remove unirrigated'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">`Irrigation Practice`</span>, <span class="st">'Acres'</span>, <span class="va">`I`</span><span class="op">:</span><span class="va">`T`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2 gather irrigation practice'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Acres</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Acres</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co">## 1522162</span></span>
<span>  <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">"fsa2 remove 0's and missing data"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>`County Name`<span class="op">=</span><span class="va">County</span>, `Crop Type Name`<span class="op">=</span><span class="st">'Crop Type'</span>, `Crop Name`<span class="op">=</span><span class="va">Crop</span><span class="op">)</span></span>
<span></span>
<span><span class="va">State_table</span><span class="op">[</span><span class="fl">55</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"60"</span>,<span class="st">"AMERICAN SAMOA"</span>, <span class="st">"AS"</span><span class="op">)</span></span>
<span><span class="va">fsa2b</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">fsa2b</span>, <span class="va">State_table</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa2 state join'</span><span class="op">)</span></span></code></pre></div>
<p>The types of acreage values, such as Planted Acres, Failed Acres,
etc., which are listed in separate columns in the raw tables, are
separated in to distinct rows. Then the acreage values are summed for
each year, county, crop, crop type, intended use, irrigation practice,
and type. Prior to that operation, each row represented a specific
(though unnamed) farm, now the rows represent the totals for the county.
The rows for nonirrigated acreage are removed, because that information
is implicit in the values for irrigated and total acreage.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fsa</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">fsa1</span>, <span class="va">fsa2b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/track_dataset.html">track_dataset</a></span><span class="op">(</span><span class="st">'fsa'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">fsa</span>, <span class="st">'../data-raw/acresFSA_compilation.rds'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">fsa1</span>, <span class="va">fsa2</span>, <span class="va">fsa2b</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">data_manipulation_log</span>, <span class="st">'../data-raw/data_compilation_log.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### TODO: Read in farm counts</span></span>
<span><span class="co"># read_farm_count &lt;- function(x) {read_xlsx(x, sheet='farm_count')}</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by C A Pellett, State of South Carolina Department of Natural Resources.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
